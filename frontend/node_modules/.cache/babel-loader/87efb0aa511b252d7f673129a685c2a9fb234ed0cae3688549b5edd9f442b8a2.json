{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\chand\\\\Downloads\\\\chat-app-project\\\\frontend\\\\src\\\\components\\\\ChatWindow.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState, useRef } from 'react';\nimport { useParams } from 'react-router-dom';\nimport TableResponse from './TableResponse';\nimport AnswerFeedback from './AnswerFeedback';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function ChatWindow() {\n  _s();\n  var _session$history, _session$history2;\n  const {\n    sessionId\n  } = useParams();\n  const [session, setSession] = useState(null);\n  const [question, setQuestion] = useState('');\n  const [loading, setLoading] = useState(false);\n  const bottomRef = useRef();\n  useEffect(() => {\n    if (!sessionId) return;\n    fetch(`http://localhost:4000/api/session/${sessionId}`).then(r => r.json()).then(d => setSession(d.session)).catch(err => console.error(err));\n  }, [sessionId]);\n  useEffect(() => {\n    var _bottomRef$current;\n    (_bottomRef$current = bottomRef.current) === null || _bottomRef$current === void 0 ? void 0 : _bottomRef$current.scrollIntoView({\n      behavior: 'smooth'\n    });\n  }, [session]);\n  function send() {\n    if (!question.trim()) return;\n    setLoading(true);\n    fetch(`http://localhost:4000/api/chat/${sessionId}`, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        question\n      })\n    }).then(r => r.json()).then(d => {\n      setQuestion('');\n      // refresh session\n      return fetch(`http://localhost:4000/api/session/${sessionId}`);\n    }).then(r => r.json()).then(d => {\n      setSession(d.session);\n      setLoading(false);\n    }).catch(err => {\n      console.error(err);\n      setLoading(false);\n    });\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"card rounded-lg shadow p-4 h-[75vh] flex flex-col\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex items-center justify-between mb-4\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-lg font-semibold\",\n          children: (session === null || session === void 0 ? void 0 : session.title) || sessionId\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 46,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-sm text-gray-500\",\n          children: [(session === null || session === void 0 ? void 0 : (_session$history = session.history) === null || _session$history === void 0 ? void 0 : _session$history.length) || 0, \" messages\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 47,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 45,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 44,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex-1 overflow-auto mb-4\",\n      children: [session === null || session === void 0 ? void 0 : (_session$history2 = session.history) === null || _session$history2 === void 0 ? void 0 : _session$history2.map(m => /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mb-4 p-3 rounded border\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-sm text-gray-600 mb-2\",\n          children: [\"Q: \", m.question]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 54,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"mb-2\",\n          children: m.answerText\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 55,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(TableResponse, {\n          table: m.table\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 56,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(AnswerFeedback, {\n          messageId: m.id,\n          sessionId: sessionId,\n          feedback: m.feedback\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 57,\n          columnNumber: 13\n        }, this)]\n      }, m.id, true, {\n        fileName: _jsxFileName,\n        lineNumber: 53,\n        columnNumber: 11\n      }, this)), /*#__PURE__*/_jsxDEV(\"div\", {\n        ref: bottomRef\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 60,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 51,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex gap-2\",\n      children: [/*#__PURE__*/_jsxDEV(\"input\", {\n        value: question,\n        onChange: e => setQuestion(e.target.value),\n        className: \"flex-1 p-2 rounded border\",\n        placeholder: \"Ask something...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 64,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: send,\n        disabled: loading,\n        className: \"px-4 py-2 rounded bg-violet-500 text-white\",\n        children: loading ? '...' : 'Send'\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 65,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 63,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 43,\n    columnNumber: 5\n  }, this);\n}\n_s(ChatWindow, \"U7hFqg2qxgVisDg6WTS+y/SYCQA=\", false, function () {\n  return [useParams];\n});\n_c = ChatWindow;\nvar _c;\n$RefreshReg$(_c, \"ChatWindow\");","map":{"version":3,"names":["React","useEffect","useState","useRef","useParams","TableResponse","AnswerFeedback","jsxDEV","_jsxDEV","ChatWindow","_s","_session$history","_session$history2","sessionId","session","setSession","question","setQuestion","loading","setLoading","bottomRef","fetch","then","r","json","d","catch","err","console","error","_bottomRef$current","current","scrollIntoView","behavior","send","trim","method","headers","body","JSON","stringify","className","children","title","fileName","_jsxFileName","lineNumber","columnNumber","history","length","map","m","answerText","table","messageId","id","feedback","ref","value","onChange","e","target","placeholder","onClick","disabled","_c","$RefreshReg$"],"sources":["C:/Users/chand/Downloads/chat-app-project/frontend/src/components/ChatWindow.js"],"sourcesContent":["import React, { useEffect, useState, useRef } from 'react';\nimport { useParams } from 'react-router-dom';\nimport TableResponse from './TableResponse';\nimport AnswerFeedback from './AnswerFeedback';\n\nexport default function ChatWindow() {\n  const { sessionId } = useParams();\n  const [session, setSession] = useState(null);\n  const [question, setQuestion] = useState('');\n  const [loading, setLoading] = useState(false);\n  const bottomRef = useRef();\n\n  useEffect(() => {\n    if (!sessionId) return;\n    fetch(`http://localhost:4000/api/session/${sessionId}`)\n      .then(r => r.json())\n      .then(d => setSession(d.session))\n      .catch(err => console.error(err));\n  }, [sessionId]);\n\n  useEffect(() => {\n    bottomRef.current?.scrollIntoView({ behavior: 'smooth' });\n  }, [session]);\n\n  function send() {\n    if (!question.trim()) return;\n    setLoading(true);\n    fetch(`http://localhost:4000/api/chat/${sessionId}`, {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify({ question })\n    }).then(r => r.json()).then(d => {\n      setQuestion('');\n      // refresh session\n      return fetch(`http://localhost:4000/api/session/${sessionId}`);\n    }).then(r => r.json()).then(d => {\n      setSession(d.session);\n      setLoading(false);\n    }).catch(err => { console.error(err); setLoading(false); });\n  }\n\n  return (\n    <div className=\"card rounded-lg shadow p-4 h-[75vh] flex flex-col\">\n      <div className=\"flex items-center justify-between mb-4\">\n        <div>\n          <div className=\"text-lg font-semibold\">{session?.title || sessionId}</div>\n          <div className=\"text-sm text-gray-500\">{session?.history?.length || 0} messages</div>\n        </div>\n      </div>\n\n      <div className=\"flex-1 overflow-auto mb-4\">\n        {session?.history?.map(m => (\n          <div key={m.id} className=\"mb-4 p-3 rounded border\">\n            <div className=\"text-sm text-gray-600 mb-2\">Q: {m.question}</div>\n            <div className=\"mb-2\">{m.answerText}</div>\n            <TableResponse table={m.table} />\n            <AnswerFeedback messageId={m.id} sessionId={sessionId} feedback={m.feedback} />\n          </div>\n        ))}\n        <div ref={bottomRef} />\n      </div>\n\n      <div className=\"flex gap-2\">\n        <input value={question} onChange={e => setQuestion(e.target.value)} className=\"flex-1 p-2 rounded border\" placeholder=\"Ask something...\" />\n        <button onClick={send} disabled={loading} className=\"px-4 py-2 rounded bg-violet-500 text-white\">\n          {loading ? '...' : 'Send'}\n        </button>\n      </div>\n    </div>\n  );\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}